### RF2 - Cadastro e Gerenciamento de Vagas - API Collection

# ============================================================================
# AUTENTICAÇÃO
# ============================================================================

### Login
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "senha123"
}

### Salvar token (copie do response acima)
@token = seu_token_aqui


# ============================================================================
# CRUD DE VAGAS - CREATE
# ============================================================================

### 1. Criar vaga em rascunho
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Desenvolvedor Full Stack Sênior",
  "description": "Buscamos desenvolvedor experiente para liderar projetos de grande escala",
  "requirements": "- 5+ anos de experiência com Node.js e React\n- Experiência com PostgreSQL\n- Conhecimento em arquitetura de microsserviços\n- Inglês avançado",
  "seniority": "senior",
  "location_type": "hybrid",
  "status": "draft",
  "salary_min": 12000,
  "salary_max": 18000,
  "contract_type": "CLT",
  "department": "Engenharia",
  "unit": "São Paulo - SP",
  "is_remote": false,
  "benefits": ["Vale Refeição", "Vale Transporte", "Plano de Saúde", "Home Office"],
  "skills_required": ["Node.js", "React", "PostgreSQL", "Docker", "Kubernetes"]
}

### 2. Criar vaga já publicada
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Analista de Dados Pleno",
  "description": "Profissional para análise de dados e criação de dashboards",
  "requirements": "- 3+ anos com análise de dados\n- SQL avançado\n- Power BI ou Tableau\n- Python para análise",
  "seniority": "pleno",
  "location_type": "onsite",
  "status": "open",
  "salary_min": 8000,
  "salary_max": 12000,
  "contract_type": "CLT",
  "department": "Data",
  "unit": "Rio de Janeiro - RJ",
  "is_remote": false,
  "skills_required": ["SQL", "Python", "Power BI", "Estatística"]
}

### 3. Criar vaga remota
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "DevOps Engineer",
  "description": "Engenheiro DevOps para automatização e infraestrutura",
  "requirements": "- Experiência com AWS ou Azure\n- Terraform e Ansible\n- CI/CD pipelines\n- Monitoramento (Prometheus, Grafana)",
  "seniority": "senior",
  "location_type": "remote",
  "status": "open",
  "salary_min": 15000,
  "salary_max": 22000,
  "contract_type": "PJ",
  "department": "Infraestrutura",
  "is_remote": true,
  "skills_required": ["AWS", "Terraform", "Docker", "Kubernetes", "CI/CD"]
}

### 4. Criar vaga sem campos opcionais (validação mínima)
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Desenvolvedor Junior",
  "description": "Oportunidade para iniciar carreira em desenvolvimento",
  "requirements": "- Formação em Ciência da Computação ou área relacionada\n- Conhecimento básico em programação"
}


# ============================================================================
# CRUD DE VAGAS - READ (LISTAGEM)
# ============================================================================

### 5. Listar todas as vagas (paginação padrão)
GET http://localhost:3000/api/jobs
Authorization: Bearer {{token}}

### 6. Listar vagas com paginação customizada
GET http://localhost:3000/api/jobs?page=1&limit=5
Authorization: Bearer {{token}}

### 7. Filtrar vagas por status
GET http://localhost:3000/api/jobs?status=open
Authorization: Bearer {{token}}

### 8. Filtrar vagas por departamento
GET http://localhost:3000/api/jobs?department=Engenharia
Authorization: Bearer {{token}}

### 9. Filtrar vagas por senioridade
GET http://localhost:3000/api/jobs?seniority=senior
Authorization: Bearer {{token}}

### 10. Filtrar vagas remotas
GET http://localhost:3000/api/jobs?is_remote=true
Authorization: Bearer {{token}}

### 11. Filtrar vagas híbridas
GET http://localhost:3000/api/jobs?location_type=hybrid
Authorization: Bearer {{token}}

### 12. Busca textual no título
GET http://localhost:3000/api/jobs?q=desenvolvedor
Authorization: Bearer {{token}}

### 13. Filtrar por período
GET http://localhost:3000/api/jobs?date_from=2025-11-01&date_to=2025-11-30
Authorization: Bearer {{token}}

### 14. Filtros combinados
GET http://localhost:3000/api/jobs?status=open&department=Engenharia&seniority=senior&sort_by=created_at&order=desc
Authorization: Bearer {{token}}

### 15. Ordenar por data de atualização
GET http://localhost:3000/api/jobs?sort_by=updated_at&order=asc
Authorization: Bearer {{token}}


# ============================================================================
# CRUD DE VAGAS - READ (DETALHAMENTO)
# ============================================================================

### 16. Obter detalhes de uma vaga específica (substitua JOB_ID)
@jobId = cole_o_id_aqui
GET http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}


# ============================================================================
# CRUD DE VAGAS - UPDATE
# ============================================================================

### 17. Atualizar título e descrição
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Desenvolvedor Full Stack Sênior - ATUALIZADO",
  "description": "Descrição atualizada com mais detalhes sobre o cargo"
}

### 18. Publicar vaga (mudar status de draft para open)
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "open"
}

### 19. Pausar vaga
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "paused"
}

### 20. Fechar vaga
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "closed"
}

### 21. Atualizar faixa salarial
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "salary_min": 13000,
  "salary_max": 20000
}

### 22. Atualizar benefícios e skills
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "benefits": ["Vale Refeição", "Vale Transporte", "Plano de Saúde", "Home Office", "Gympass"],
  "skills_required": ["Node.js", "React", "PostgreSQL", "Docker", "Kubernetes", "GraphQL"]
}

### 23. Mudar departamento e unidade
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "department": "Tecnologia",
  "unit": "Brasília - DF"
}

### 24. Atualização vazia (deve retornar erro)
PUT http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{}


# ============================================================================
# CRUD DE VAGAS - DELETE
# ============================================================================

### 25. Soft delete de vaga (arquivar)
DELETE http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}

### 26. Tentar obter vaga deletada (deve retornar 404)
GET http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}


# ============================================================================
# BUSCA TEXTUAL
# ============================================================================

### 27. Busca textual avançada
GET http://localhost:3000/api/jobs/search/text?q=desenvolvedor&limit=10
Authorization: Bearer {{token}}

### 28. Busca textual com query curta (deve retornar erro)
GET http://localhost:3000/api/jobs/search/text?q=de
Authorization: Bearer {{token}}


# ============================================================================
# MÉTRICAS E DASHBOARD
# ============================================================================

### 29. Métricas consolidadas de vagas
GET http://localhost:3000/api/dashboard/jobs/metrics
Authorization: Bearer {{token}}

### 30. Timeline de vagas (últimos 30 dias)
GET http://localhost:3000/api/dashboard/jobs/timeline?days=30
Authorization: Bearer {{token}}

### 31. Timeline de vagas (últimos 7 dias)
GET http://localhost:3000/api/dashboard/jobs/timeline?days=7
Authorization: Bearer {{token}}

### 32. Timeline de vagas (últimos 90 dias)
GET http://localhost:3000/api/dashboard/jobs/timeline?days=90
Authorization: Bearer {{token}}


# ============================================================================
# TESTES DE VALIDAÇÃO
# ============================================================================

### 33. Criar vaga sem título (deve retornar erro 400)
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "description": "Descrição sem título",
  "requirements": "Requisitos"
}

### 34. Criar vaga sem descrição (deve retornar erro 400)
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Título sem descrição",
  "requirements": "Requisitos"
}

### 35. Criar vaga com slug duplicado (deve retornar erro 409)
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Desenvolvedor Full Stack Sênior",
  "slug": "desenvolvedor-full-stack-senior",
  "description": "Descrição",
  "requirements": "Requisitos"
}


# ============================================================================
# TESTES DE SEGURANÇA E MULTITENANT
# ============================================================================

### 36. Tentar acessar vaga de outra empresa (deve retornar 404)
# Primeiro, faça login com usuário de outra empresa
# Depois, tente acessar jobId da empresa anterior
GET http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}

### 37. Tentar criar vaga sem permissão ADMIN (deve retornar 403)
# Faça login com usuário RECRUITER
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Teste sem permissão",
  "description": "Descrição",
  "requirements": "Requisitos"
}


# ============================================================================
# TESTES DE PERFORMANCE
# ============================================================================

### 38. Listar com limite máximo permitido (100)
GET http://localhost:3000/api/jobs?limit=100
Authorization: Bearer {{token}}

### 39. Listar com limite acima do máximo (deve limitar em 100)
GET http://localhost:3000/api/jobs?limit=500
Authorization: Bearer {{token}}


# ============================================================================
# HISTÓRICO DE REVISÕES
# ============================================================================

### 40. Obter vaga com histórico de revisões
# Após fazer várias atualizações na mesma vaga
GET http://localhost:3000/api/jobs/{{jobId}}
Authorization: Bearer {{token}}


# ============================================================================
# CASOS DE USO COMPLETOS
# ============================================================================

### 41. Fluxo completo: Criar → Publicar → Pausar → Reabrir → Fechar

# Passo 1: Criar vaga em rascunho
POST http://localhost:3000/api/jobs
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "QA Engineer",
  "description": "Profissional para garantia de qualidade",
  "requirements": "Experiência com testes automatizados",
  "status": "draft"
}

# Passo 2: Publicar (copie o ID retornado)
# PUT http://localhost:3000/api/jobs/{ID} com {"status": "open"}

# Passo 3: Pausar
# PUT http://localhost:3000/api/jobs/{ID} com {"status": "paused"}

# Passo 4: Reabrir
# PUT http://localhost:3000/api/jobs/{ID} com {"status": "open"}

# Passo 5: Fechar
# PUT http://localhost:3000/api/jobs/{ID} com {"status": "closed"}

# Passo 6: Ver histórico de revisões
# GET http://localhost:3000/api/jobs/{ID}
